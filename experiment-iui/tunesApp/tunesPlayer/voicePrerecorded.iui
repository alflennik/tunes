* () {
  [makeAudio:, Audio:] = import("core:web")

  &status[%]([.cleared, .playing, .paused]) = .cleared

  getPermissions = async () {
    * makePromise((resolve) {
      audioElement = makeAudio("./audio/none.mp3")
      audioElement.addEventListener("ended", () : resolve() ;)
      audioElement.play()
    }).await
  }

  &activePromise[%](Promise())<?>
  &activeElement[%](Audio)<?>

  say = async (spokenItem) {
    filePath = spokenItem.filePath[?!!]
    audioElement = makeAudio(filePath)

    if &activePromise<?> && &activeElement<?>.paused != false {
      &activePromise.await
    }

    &activeElement = audioElement

    &activePromise = makePromise((resolve) {
      endListener = () {
        &activeElement.removeEventListener("ended", endListener)
        &activeElement<?> = null
        &activePromise<?> = null
        &status = .cleared
        resolve()
      }
      activeElement.addEventListener("ended", endListener)
    }).unawait

    &status = .playing
    &activeElement.play()

    * activePromise.await
  }

  clear = () {
    if !&activeElement<?> : * ;
    &activeElement.pause()
    &activeElement<?> = null
    &activePromise<?> = null
    &status = .cleared
  }

  pause = () {
    if !&activeElement<?> : * ;
    &activeElement.pause()
    &status = .paused
  }

  play = () {
    if !&activeElement<?> : * ;
    &activeElement.play()
    &status = .playing
  }

  * [getPermissions:, say:, clear:, pause:, play:]
}